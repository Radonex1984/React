function t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function e(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(t,e,r,n,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,a)}function n(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var i=t.apply(e,n);function s(t){r(i,a,o,s,c,"next",t)}function c(t){r(i,a,o,s,c,"throw",t)}s(void 0)}))}}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o={name:"name",url:"url",homepage:"homepage",favicon:"favicon",tags:"tags",country:"country",state:"state",language:"language",votes:"votes",codec:"codec",bitrate:"bitrate",lastCheckOK:"lastCheckOK",lastCheckTime:"lastCheckTime",clickTimeStamp:"clickTimeStamp",clickCount:"clickCount",clickTrend:"clickTrend",random:"random"},i={byUuid:"byUuid",byName:"byName",byNameExact:"byNameExact",byCodec:"byCodec",byCodexExact:"byCodecExact",byCountry:"byCountry",byCountryExact:"byCountryExact",byCountryCodeExact:"byCountryCodeExact",byState:"byState",byStateExact:"byStateExact",byLanguage:"byLanguage",byLanguageExact:"byLanguageExact",byTag:"byTag",byTagExact:"byTagExact"};class s{constructor(t,e=!0){if(this.appName=t,this.hideBroken=e,this.baseUrl=void 0,this.fetchConfig={method:"GET",redirect:"follow"},!t)throw new Error("appName is required");this.fetchConfig.headers={"user-agent":this.appName}}resolveBaseUrl(){var t=arguments;return n((function*(){var e=t.length>0&&void 0!==t[0]?t[0]:{};if("undefined"!=typeof window)return[{ip:"45.77.62.161",name:"fr1.api.radio-browser.info"}];var r=yield fetch("http://all.api.radio-browser.info/json/servers",e);if(r.ok)return yield r.json();throw r}))()}setBaseUrl(t){this.baseUrl=t}getBaseUrl(){return this.baseUrl}getCountries(t,e,r){var a=this;return n((function*(){return a.runRequest(a.buildRequest("countries",t,e),r)}))()}getCountryCodes(t,e,r){var a=this;return n((function*(){return t=t?"".concat(t.toUpperCase()):"",a.runRequest(a.buildRequest("countrycodes",t,e),r)}))()}getCodecs(t,e){var r=this;return n((function*(){return r.runRequest(r.buildRequest("codecs","",t),e)}))()}getCountryStates(t,e,r){var a=this;return n((function*(){return a.runRequest(a.buildRequest("states",t,e),r)}))()}getLanguages(t,e,r){var a=this;return n((function*(){return a.runRequest(a.buildRequest("languages",t,e),r)}))()}getTags(t,e,r){var a=this;return n((function*(){return t=t?t.toLowerCase():"",a.runRequest(a.buildRequest("tags",t,e),r)}))()}getStationsBy(t,e,r,a){var o=arguments,s=this;return n((function*(){var n=o.length>4&&void 0!==o[4]&&o[4];if(!i[t])throw new Error("search type does not exist: ".concat(t));e=e?e.toLowerCase():"";var c=yield s.runRequest(s.buildRequest("stations/".concat(t.toLowerCase()),e,r),a);return s.normalizeStations(c,n)}))()}normalizeStations(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n={};for(var a of t){if(e){var o="".concat(a.name.toLowerCase().trim()).concat(a.url.toLowerCase().trim());if(n[o])continue;n[o]=!0}var i={changeId:a.changeuuid,id:a.stationuuid,name:a.name,url:a.url,urlResolved:a.url_resolved,homepage:a.homepage,favicon:a.favicon,country:a.country,countryCode:a.countrycode,state:a.state,votes:a.votes,codec:a.codec,bitrate:a.bitrate,clickCount:a.clickcount,clickTrend:a.clicktrend,hls:Boolean(a.hls),lastCheckOk:Boolean(a.lastcheckok),lastChangeTime:new Date(a.lastchangetime),lastCheckOkTime:new Date(a.lastcheckoktime),clickTimestamp:new Date(a.clicktimestamp),lastLocalCheckTime:new Date(a.lastlocalchecktime),language:a.language.split(","),lastCheckTime:new Date(a.lastchecktime),tags:[...new Set(a.tags.split(","))].filter((t=>t.length>0&&t.length<10))};r.push(i)}return r}getAllStations(t,e){var r=arguments,a=this;return n((function*(){var n=r.length>2&&void 0!==r[2]&&r[2],o=yield a.runRequest(a.buildRequest("stations","",t),e);return a.normalizeStations(o,n)}))()}searchStations(t,e){var r=arguments,a=this;return n((function*(){var n=r.length>2&&void 0!==r[2]&&r[2],o=yield a.runRequest(a.buildRequest("stations/search",void 0,t),e);return a.normalizeStations(o,n)}))()}getStationsByClicks(t,e){var r=this;return n((function*(){return r.resolveGetStations("topclick",t,e)}))()}getStationsByVotes(t,e){var r=this;return n((function*(){return r.resolveGetStations("topvote",t,e)}))()}getStationsByRecentClicks(t,e){var r=this;return n((function*(){return r.resolveGetStations("lastclick",t,e)}))()}sendStationClick(t,e){var r=this;return n((function*(){return r.runRequest(r.buildRequest("url",t,void 0,!1),e)}))()}voteForStation(t,e){var r=this;return n((function*(){return r.runRequest(r.buildRequest("vote",t),e)}))()}getStationsById(t,e){var r=this;return n((function*(){var n=t.join(","),a=yield r.runRequest(r.buildRequest("stations/byuuid?uuids=".concat(n),void 0,void 0,!1),e);return r.normalizeStations(a)}))()}getStationByUrl(t,e){var r=this;return n((function*(){var n=yield r.runRequest(r.buildRequest("stations/byurl/".concat(t),void 0,void 0,!1),e);return r.normalizeStations(n)}))()}resolveGetStations(t,e,r){var a=this;return n((function*(){var n=e?"/".concat(e):"",o=yield a.runRequest(a.buildRequest("stations/".concat(t).concat(n),void 0,void 0,!1),r);return a.normalizeStations(o)}))()}buildRequest(t,r,n){var a,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];r=r?"/".concat(encodeURIComponent(r)):"",n&&("tagList"in(a=e({},n))&&Array.isArray(a.tagList)&&(a.tagList=[...a.tagList]),o&&void 0===a.hideBroken&&(a.hideBroken=this.hideBroken));var i=a?this.createQueryParams(a):"";return"".concat(t).concat(r).concat(i)}runRequest(t){var r=arguments,a=this;return n((function*(){var n=r.length>1&&void 0!==r[1]?r[1]:{},o=e(e(e({},a.fetchConfig),n),{},{headers:e(e({},a.fetchConfig.headers),n.headers)});if(!a.baseUrl){var i=yield a.resolveBaseUrl(),s=Math.floor(Math.random()*i.length);a.baseUrl="https://".concat(i[s].name)}var c=yield fetch("".concat(a.baseUrl,"/json/").concat(t),o);if(c.ok)return c.json();throw c}))()}createQueryParams(t){var e="";if(t)for(var[r,n]of Object.entries(t))e+="&".concat(r,"=").concat(encodeURIComponent(n));return e?"?".concat(e.slice(1).toLowerCase()):""}}s.version="5.0.0";export{s as RadioBrowserApi,o as StationSearchOrder,i as StationSearchType};
//# sourceMappingURL=index.esm.min.js.map
